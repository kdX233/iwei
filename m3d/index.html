<!doctype html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8" />
  <title id="pagetitle">M3D-Web 应用激活</title>
  <script src="https://unpkg.com/sober@0.2.13/dist/sober.min.js"></script>
  <link rel="stylesheet" href="https://rs.kdxiaoyi.top/res/css/sober-theme-turquoise.css" />
  <link rel="stylesheet" href="https://rs.kdxiaoyi.top/res/css/main.css">
  <link rel="stylesheet" href="https://rs.kdxiaoyi.top/res/css/font.css">
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
</head>
<body>
  <div id="noscript" style="text-align: center;"><b>由于您似乎禁用了Javascript或者出于其它原因，页面无法正常加载。<br>a此外，该应用不兼容IE系浏览器。</b></div><!-- 未启用js或者js加载失败的提示 -->
  <!-- 标题栏 -->
  <s-appbar>
    <div id="titlebar" slot="headline"> M3D-Web </div>
     </s-appbar>
  <s-page weigh="100vw" height="100vh" id="app" class="app"><s-scroll-view><div class="appScroll" style="height: 100vh;width: 100vw">
    <!-- 跳板元素 -->
    <s-snackbar id='snackbar'></s-snackbar>
    <a target="_self" id="goto" style="display:none;" href="void(0)"></a>
    <!-- 页面主体元素 -->
    <div id="welcome" class="welcome-text"><!-- 欢迎界面 -->
      <p><big>欢迎使用M3D-Web</big></p>
      <p《现代三连词典》在线版本</p>
      <br>
      <p>
        输入您的随书附赠产品密钥以激活M3D-Web
        <b>该密钥一般位于封底扉页处</b>
      </p><br>
      <s-search>
          <s-icon type="search" slot="start"></s-icon>
          <input id="new_uri" type="text" placeholder="Product activation key...">
          <s-icon-button onclick="document.getElementById('new_uri').value='';" slot="end"><s-icon type="close" ></s-icon></s-icon-button>
      </s-search><br><br>
      <s-button onclick="newSearch(getElementById('new_uri').value);"><s-icon type="search" slot="start"></s-icon>激活产品</s-button>
    </div>
  </div></s-scroll-view></s-page>
<script>
function setCookie(cname, cvalue, exdays) { var d = new Date(); d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000)); var expires = "expires=" + d.toGMTString(); document.cookie = cname + "=" + cvalue + "; " + expires };
function getCookie(cname) { var name = cname + "="; var ca = document.cookie.split(';'); for (var i = 0; i < ca.length; i++) { var c = ca[i].trim(); if (c.indexOf(name) == 0) return c.substring(name.length, c.length) }; return null };
const crypto=(str,seed=0)=>{let h1=0xdeadbeef^seed,h2=0x41c6ce57^seed;for(let i=0,ch;i<str.length;i++){ch=str.charCodeAt(i);h1=Math.imul(h1^ch,2654435761);h2=Math.imul(h2^ch,1597334677)}h1=Math.imul(h1^(h1>>>16),2246822507)^Math.imul(h2^(h2>>>13),3266489909);h2=Math.imul(h2^(h2>>>16),2246822507)^Math.imul(h1^(h1>>>13),3266489909);return 4294967296*(2097151&h2)+(h1>>>0)};
const key=["m3d-web-",7889319493997866];
function removeElement(ElementId) { document.getElementById(ElementId).remove();if (local) {console.log("Removed Element, Id="+ElementId);};return;};
function msg(Message, confirmTips) {if ( confirmTips == undefined ) {snackbar.innerHTML = Message;} else {snackbar.innerHTML = Message+`<s-button type="text" slot="action"> `+confirmTips+` </s-button>`;};snackbar.show();return;};//封装了一个Material Design的Tipbox
function getQueryString(name) { let reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i"); let r = window.location.search.substr(1).match(reg); if (r != null) { return unescape(r[2]); }; return null; };
function setUItitle(Title) {if (Title == undefined) {document.getElementById("titlebar").innerHTML="M3D-Web"} else {document.getElementById("titlebar").innerHTML=Title};return;};
function setPageTitle(Title) {if (Title == undefined) {document.getElementById("pagetitle").innerHTML="M3D-Web";} else {document.getElementById("pagetitle").innerHTML=Title+` - M3D-Web`;};return;};
function newSearch(uri) {
  if ( key.indexOf(crypto(key[0]+uri.toUpperCase())) <= 0 ) {
  msg("× 无效产品密钥");return;
};
  msg("✓ 激活成功，正在跳转……");
  setCookie("m3d_auth",uri.toUpperCase(),214748);
  goto.setAttribute("href",`https://iwei.kdxiaoyi.top/m3d/c`);
  goto.click();
};
//定义变量与常量
const goto=document.getElementById("goto");
const hide="display:none;";const unhide="";
var id=0;
const snackbar=document.getElementById("snackbar");
//link域识别

let localReg = /(127\.0\.0\.1)|(0\.0\.0\.0)|(localhost)|(debug\.kdxiaoyi\.top)/i;
{
  if (localReg.test(window.location.href)) {msg("检测到本地调试状态，原文内容将不可用。","了解");setUItitle(`M3D-Web [LoaclDebug]`);const local=true;};
};
if (getQueryString("ref")=="f") {msg("× 未经授权的访问");};
//移除noscript标识
console.log ("M3D-Web");console.log("Copyright (C) 2024 kdxiaoyi. All right reserved.\nSee more @ //kdx233.github.io/licen");
document.getElementById("noscript").setAttribute("style", "display:none;");
</script>
<style>
.disabled-a{
  color: #000;
  cursor:auto;
  pointer-events:none;
  text-decoration: none;
}
</style>
</body>
</html>